<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Intranet Drotium">
	<meta name="author" content="Alejandro Campos - Drotium">
	<!-- default header name is X-CSRF-TOKEN -->
	<meta name="_csrf" th:content="${_csrf.token}" />
	<meta name="_csrf_header" th:content="${_csrf.headerName}" />
	<title>Drotium Intranet</title>
	<th:block th:include="includes/links :: links"></th:block>
	<link th:href="@{/css/admin.css}" rel="stylesheet">
</head>

<body class="fixed-nav sticky-footer sidenav-toggled" id="page-top">

	<!-- Navigation-->
	<th:block th:include="includes/navbar :: navbar"></th:block>

	<div class="content-wrapper">
		<div class="row m-1">
			<div class="col-8 container-fluid">
				<div class="text-center" th:if="${#lists.size(users) != 0}">
					<h5 class="alert mt-2 ml-2 mr-2 font-weight-bold text-white" style="background-color:#51C3F1;">Current Active Users</h5>
				</div>
				<div class="row" th:if="${#lists.size(users) != 0}">
					<div class="col col-sm-6 mb-3" th:each="user:${users}">
						<div class="card" th:classappend="${user.active == 0} ? border-danger">
							<div class="card-body">
								<div class="d-flex w-100 justify-content-between">
									<h5 class="card-title" th:text="${user.name} + ' ' + ${user.lastName}"></h5>
									<small th:if="${user.lastConnect != null}" th:with="days=${T(java.util.concurrent.TimeUnit).DAYS}, millis=${T(java.util.concurrent.TimeUnit).MILLISECONDS}" th:text="'Last connection: ' + ${days.convert(#dates.createNow().getTime() - user.lastConnect.getTime(), millis)} + ' days ago'"></small>
									<small th:if="${user.lastConnect == null}">Last connection: never</small>
								</div>
								<p class="card-text" th:text="${user.email}"></p>
								<a id="delete" class="btn btn-danger btn-sm pull-right mr-2 text-white"><i class="fa fa-times" aria-hidden="true"></i><input type="hidden" th:value="${user.encrypt()}"></a>
								<a id="editU" class="btn btn-sm pull-right mr-2 text-white" style="background-color:#51C3F1;border-color:#51C3F1;"><i class="fa fa-edit" aria-hidden="true"></i><input type="hidden" th:value="${user.encrypt()}"></a>
							</div>
						</div>
					</div>
				</div>
				<div class="text-center" th:if="${#lists.size(notifications) != 0}">
					<h5 class="alert mt-2 ml-2 mr-2 font-weight-bold text-white" style="background-color:#51C3F1;">Deactivated Users</h5>
				</div>
				<div class="row" th:if="${#lists.size(notifications) != 0}">
					<div class="col col-sm-6 mb-3" th:each="notif:${notifications}">
						<div class="card">
							<div class="card-body">
								<div class="d-flex w-100 justify-content-between">
									<h5 class="card-title" th:text="${notif.sender.name} + ' ' + ${notif.sender.lastName}"></h5>
									<div th:with="days=${T(java.util.concurrent.TimeUnit).DAYS}, millis=${T(java.util.concurrent.TimeUnit).MILLISECONDS}" th:switch="${days.convert(#dates.createNow().getTime() - notif.sender.creation.getTime(), millis)}">
										<small th:case="0">Today</small>
										<small th:case="*" th:with="days=${T(java.util.concurrent.TimeUnit).DAYS}, millis=${T(java.util.concurrent.TimeUnit).MILLISECONDS}" th:text="${days.convert(#dates.createNow().getTime() - notif.sender.creation.getTime(), millis) + ' days ago'}"></small>
									</div>
								</div>
								<p class="card-text" th:text="${notif.sender.email}"></p>
								<a id="refuse" class="btn btn-danger btn-sm pull-right mr-2 text-white"><i class="fa fa-times" aria-hidden="true"></i>
									<input type="hidden" th:value="${notif.sender.encrypt()}"></input>
									Refuse
								</a>
								<a id="accept" class="btn btn-sm pull-right mr-2 text-white" style="background-color:#51C3F1;border-color:#51C3F1;"><i class="fa fa-check" aria-hidden="true"></i>
									<input type="hidden" th:value="${notif.sender.encrypt()}"></input>
									Accept
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<div class="container-fluid col-4">
				<div class="card">
					<div class="text-center">
						<h5 class="alert mt-2 ml-2 mr-2 font-weight-bold text-white" style="background-color:#51C3F1;">Create New Notification</h5>
					</div>
					<div 
					<div class="form-group dro-border ml-3 mr-3">
						<select class="form-control mb-2" id="nType">
					    	<option>Advice</option>
					    </select>
						<textarea class="form-control" id="nContent" maxlength="200" rows="10" placeholder="Write something here..."></textarea>
						<button class="btn btn-sm pull-right" style="background-color:#51C3F1;border-color:#51C3F1;">Send</button>
					</div>
				</div>
				<div class="mt-3"> 
					<div class="card" th:each="notify:${notifies}">
						<div class="card-body">
							<div class="d-flex w-100 justify-content-between">
								<h5 class="card-title" th:text="${notify.type}"></h5>
								<small th:text="${#dates.format(notify.creation, 'dd-MM-yyyy')}"></small>
							</div>
							<p class="card-text" th:text="${notify.content}"></p>
							<a id="nRemove" class="btn btn-danger btn-sm pull-right mr-2 text-white">
								<i class="fa fa-times" aria-hidden="true"></i>
								<input type="hidden" value=""></input>
								Remove
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

		<!-- EDIT MODAL -->
		<div class="modal fade" id="editModal" tabindex="-1" role="dialog"
		aria-labelledby="editModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document">
			<form method="POST">
				<div class="modal-content">
					<div class="modal-body">
						<form method="POST">
							<div class="row border border-dark rounded m-3 p-3">
								<div class="col col-md-4 form-group mb-2">
									<small for="userName" class="d-block">Name:</small>
									<input type="hidden" id="uTc" value=''>
									<input type="text" pattern="[a-zA-Z0-9\s]+" id="userName" class="form-control form-control-sm" value="" placeholder="User Name" required></input>
								</div>
								<div class="col col-md-4 form-group mb-2">
									<small for="userLastName" class="d-block">Last Name:</small>
									<input id="userLastName" pattern="[a-zA-Z0-9\s]+" class="form-control form-control-sm" value="" placeholder="Last Name" required></input>
								</div>
								<div class="col col-md-4 form-group mb-2">
									<small for="userEmail" class="d-block">Email:</small>
									<input id="userEmail" pattern="[a-zA-Z0-9.]+@drotium.com" class="form-control form-control-sm" value="" placeholder="Email" required></input>
								</div>
								<div class="col col-md-4 form-group mb-2">
									<small for="userActive" class="d-block">Active:</small>
									<span id="userActive" class="font-weight-bold d-block">Yes</span>
								</div>
								<div class="col col-md-4 form-group mb-2">
									<small for="userCreation" class="d-block">Creation:</small>
									<span id="userCreation" class="font-weight-bold d-block">19-07-2018 09:07</span>
								</div>
								<div class="col col-md-4 form-group mb-2">
									<small for="userConnect" class="d-block">Last Connection:</small>
									<span id="userConnect" class="font-weight-bold d-block">23-06-2018 10:17</span>
								</div>
								<div class="col col-md-4 form-group mb-2">
									<small for="userRole" class="d-block">Role:</small>
									<span id="userRole" class="font-weight-bold d-block">Admin</span>
								</div>
							</div>
						</form>
						<button id="uedit" class="btn btn-sm pull-right mr-3 mb-3" style="background-color:#51C3F1;border-color:#51C3F1;">Confirm</button>
						<button class="btn btn-elegant btn-sm pull-right mr-1" type="button" data-dismiss="modal">Cancel</i></button>
					</div>
				</div>
			</form>
		</div>
	</div>

	<!-- Footer -->
	<th:block th:include="includes/footer :: footer"></th:block>
	<th:block th:include="includes/scripts :: scripts"></th:block>
	<script th:src="@{/js/admin/admin.js}"></script>
	<script type="text/javascript">
	$("body").niceScroll({
		fixed:true,
		zindex:'99999999',
		cursorcolor: '#51C3F1',
		cursorborderradius: 0,
		cursorborder:'none'
	});
	</script>
</body>

</html>
